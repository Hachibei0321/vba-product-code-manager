# 商品コード追加プロシージャ 使い方ガイド 📋

## はじめに 👋
あら〜！VBA初心者のあんたにも使えるように、関西のおばちゃんが丁寧に説明したるで〜♪

## このプロシージャでできること 🚀

1. **ファイル選択** 📁
   - 任意のExcelファイル（xlsm）を選択できるで

2. **ワークシートコピー** 📋
   - 選択したファイルの「利用率リスト」と「管理マスター」を現在のワークブックにコピー

3. **商品コード照合・追加** 🔍
   - 「原価リスト」B列と「料率リスト」B列を比較
   - 一致した場合、商品コードを自動で追加

## 使用前の準備 ⚙️

### 必要なワークシート
現在開いているワークブックに以下のシートが必要やで：
- **「原価リスト」** ← 最初から開いてるやつ

選択するExcelファイルに以下のシートが必要やで：
- **「利用率リスト」** ← コピー用
- **「管理マスター」** ← コピー用  
- **「料率リスト」** ← 照合用

### データの配置
- **原価リスト**：B列（B2以降）に照合用データ
- **料率リスト**：B列（B2以降）に照合用データ、A列に商品コード

## 使い方 📖

### ステップ1：VBAエディタを開く
1. Excelで `Alt + F11` を押す
2. VBAエディタが開くで〜

### ステップ2：コードを貼り付け
1. 左側のプロジェクトエクスプローラーで「挿入」→「標準モジュール」
2. GitHubからダウンロードしたコードを貼り付け

### ステップ3：実行
1. `F5` キーまたは「実行」ボタンで `商品コード追加` を実行
2. あとは画面の指示に従うだけや♪

## 処理の流れ 🔄

```
1. [ダイアログ] → Excelファイルを選択
    ↓
2. [コピー] → 「利用率リスト」「管理マスター」をコピー
    ↓
3. [照合] → B列の値を比較
    ↓
4. [追加] → 一致したらA列に商品コードを追加
    ↓
5. [完了] → 結果をお知らせ
```

## エラーが起きた時 ⚠️

### よくあるエラーと対処法

**「シートが見つからへん」**
- シート名を確認してや
- 全角・半角、スペースも要チェック

**「ファイルが開けへん」**
- ファイルが他で開かれてないか確認
- ファイルパスに問題ないか確認

**「権限がない」**
- ファイルの読み取り専用を解除
- マクロの実行が許可されてるか確認

## カスタマイズのヒント 💡

### シート名を変更したい場合
コードの以下の部分を変更してや：

```vb
' 66行目あたり
シート名配列 = Array("利用率リスト", "管理マスター")

' 113行目あたり  
Set 原価リストシート = 現在ワークブック.Worksheets("原価リスト")
Set 料率リストシート = 選択ワークブック.Worksheets("料率リスト")
```

### 列を変更したい場合
コードの以下の部分を変更してや：

```vb
' 119-120行目あたり（最終行取得）
原価最終行 = 原価リストシート.Cells(原価リストシート.Rows.Count, "B").End(xlUp).Row
料率最終行 = 料率リストシート.Cells(料率リストシート.Rows.Count, "B").End(xlUp).Row

' 130行目あたり（照合対象列）
原価Bセル値 = Trim(CStr(原価リストシート.Cells(i, "B").Value))
```

## トラブルシューティング 🔧

### デバッグ機能を使う
- `F8` キーでステップ実行
- イミディエイトウィンドウで `Debug.Print` の内容を確認
- ブレークポイントで一時停止

### ログ確認
実行中にイミディエイトウィンドウ（`Ctrl + G`）で以下が表示されるで：
- シートコピーの状況
- 最終行の情報  
- 照合結果

## サポート 💬

何かわからんことがあったら、GitHubのIssuesで聞いてや〜
おばちゃんができる範囲でお手伝いするで♪

---

**作成者**: 関西のおばちゃん 👵  
**更新日**: 2025/06/15  
**バージョン**: 1.0

## ライセンス 📄
このコードはMITライセンスやで〜
自由に使ってもらってええからな♪
