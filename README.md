# 商品コード追加プロシージャ 使い方ガイド 📋

## はじめに 👋
あら〜！VBA初心者のあんたにも使えるように、関西のおばちゃんが**安全で確実に動く**コードを作ったで♪

## 🔧 修正点（重要！）
**変数名・関数名を英語に変更**したで！これで環境に関係なく安全に動くからな〜
- ❌ 日本語の変数名（環境によってはエラーの原因）
- ✅ 英語の変数名（どこでも安全に動く）
- ✅ コメントは関西弁でたっぷり（初心者にもわかりやすく♪）

## このプロシージャでできること 🚀

1. **ファイル選択** 📁
   - 任意のExcelファイル（xlsm）を選択できるで

2. **ワークシートコピー** 📋
   - 選択したファイルの「利用率リスト」と「管理マスター」を現在のワークブックにコピー

3. **商品コード照合・追加** 🔍
   - 「原価リスト」B列と「料率リスト」B列を比較
   - 一致した場合、商品コードを自動で追加

## 使用前の準備 ⚙️

### 必要なワークシート
現在開いているワークブックに以下のシートが必要やで：
- **「原価リスト」** ← 最初から開いてるやつ

選択するExcelファイルに以下のシートが必要やで：
- **「利用率リスト」** ← コピー用
- **「管理マスター」** ← コピー用  
- **「料率リスト」** ← 照合用

### データの配置
- **原価リスト**：B列（B2以降）に照合用データ
- **料率リスト**：B列（B2以降）に照合用データ、A列に商品コード

## 使い方 📖

### ステップ1：VBAエディタを開く
1. Excelで `Alt + F11` を押す
2. VBAエディタが開くで〜

### ステップ2：コードを貼り付け
1. 左側のプロジェクトエクスプローラーで「挿入」→「標準モジュール」
2. **ProductCodeManager.bas** のコードを貼り付け

### ステップ3：実行
1. `F5` キーまたは「実行」ボタンで `AddProductCode` を実行
2. あとは画面の指示に従うだけや♪

## 処理の流れ 🔄

```
1. [ダイアログ] → Excelファイルを選択
    ↓
2. [コピー] → 「利用率リスト」「管理マスター」をコピー
    ↓
3. [照合] → B列の値を比較
    ↓
4. [追加] → 一致したらA列に商品コードを追加
    ↓
5. [完了] → 結果をお知らせ
```

## エラーが起きた時 ⚠️

### よくあるエラーと対処法

**「シートが見つからへん」**
- シート名を確認してや
- 全角・半角、スペースも要チェック

**「ファイルが開けへん」**
- ファイルが他で開かれてないか確認
- ファイルパスに問題ないか確認

**「権限がない」**
- ファイルの読み取り専用を解除
- マクロの実行が許可されてるか確認

## 🔍 デバッグ機能

### イミディエイトウィンドウで確認
`Ctrl + G` でイミディエイトウィンドウを開いて、以下の情報を確認できるで：

```
利用率リスト をコピーしたで〜
管理マスター をコピーしたで〜
原価リスト最終行：150
料率リスト最終行：200
照合完了：ABC123 → PROD001
照合完了：DEF456 → PROD002
```

## カスタマイズのヒント 💡

### シート名を変更したい場合
**67行目あたり**のコードを変更してや：

```vb
' コピーするシート名を配列で定義
sheetNames = Array("利用率リスト", "管理マスター")
```

### 対象シートを変更したい場合
**114-115行目あたり**のコードを変更してや：

```vb
' シートの取得
Set costListSheet = targetWorkbook.Worksheets("原価リスト")
Set rateListSheet = sourceWorkbook.Worksheets("料率リスト")
```

### 列を変更したい場合
**118-119行目あたり**のコードを変更してや：

```vb
' 最終行を取得（B列の最後のデータがある行を探すで）
costLastRow = costListSheet.Cells(costListSheet.Rows.Count, "B").End(xlUp).Row
rateLastRow = rateListSheet.Cells(rateListSheet.Rows.Count, "B").End(xlUp).Row
```

## 🎯 関数・プロシージャの説明

| 関数名 | 用途 | 説明 |
|--------|------|------|
| `AddProductCode` | メイン処理 | 全体の流れを制御するで |
| `ShowFileDialog` | ファイル選択 | ユーザーにファイルを選んでもらう |
| `CopyWorksheets` | シートコピー | 指定されたシートをコピー |
| `MatchAndAddProductCode` | 照合処理 | B列を比較してA列に追加 |
| `DoesWorksheetExist` | 存在チェック | シートがあるかどうか確認 |

## トラブルシューティング 🔧

### デバッグ機能を使う
- `F8` キーでステップ実行
- ブレークポイントで一時停止
- 変数の値をマウスオーバーで確認

### 安全に動作させるために
- **テストデータで最初は試す**
- **元ファイルのバックアップを取る**
- **VBAの実行が許可されているか確認**

## サポート 💬

何かわからんことがあったら、GitHubのIssuesで聞いてや〜
おばちゃんができる範囲でお手伝いするで♪

---

**作成者**: 関西のおばちゃん 👵  
**更新日**: 2025/06/15  
**バージョン**: 2.0（安全版）

## ファイル構成 📁
- `ProductCodeManager.bas` ← **メインのVBAコード（英語ベース・安全版）**
- `商品コード追加.bas` ← 旧版（日本語ベース・参考用）
- `README.md` ← この説明書

## ライセンス 📄
このコードはMITライセンスやで〜
自由に使ってもらってええからな♪
